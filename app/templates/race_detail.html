{% extends 'base.html' %}

{% block title %}{{ race.name }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>{{ race.name }}</h2>
    <p><strong>Дата проведения:</strong> {{ race.date.strftime('%d.%m.%Y') }}</p>

    <div class="mt-3">
        <h5>Файлы:</h5>
        <ul>
            <li>
                <strong>Маршрут:</strong>
                {% if race.route_file %}
                    <a href="{{ url_for('auth.download_file', filename=race.route_file, original_name=race.route_file_orig) }}">
                        {{ race.route_file_orig }}
                    </a>
                {% else %}
                    нет
                {% endif %}
            </li>
            <li>
                <strong>Результаты:</strong>
                {% if race.result_file %}
                    <a href="{{ url_for('auth.download_file', filename=race.result_file, original_name=race.result_file_orig) }}">
                        {{ race.result_file_orig }}
                    </a>
                {% else %}
                    нет
                {% endif %}
            </li>
        </ul>
    </div>

    {% if current_user.is_authenticated %}
        {% if participated %}
            <p>
            <button class="btn btn-success" disabled>Вы участвовали</button>
            </p>
        {% else %}
            <form method="POST" action="{{ url_for('auth.join_race', race_id=race.id) }}">
                <button type="submit" class="btn btn-primary">Участвовал</button>
            </form>
        {% endif %}
    {% else %}
        <p class="mt-3">Пожалуйста, <a href="{{ url_for('auth.login') }}">войдите</a>, чтобы отметить участие.</p>
    {% endif %}

    <a href="{{ url_for('auth.home') }}" class="btn btn-secondary mt-3">← на главную</a>
</div>
{% endblock %}
